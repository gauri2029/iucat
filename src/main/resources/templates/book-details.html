<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.title} + ' - IU Cat'">Book Details</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/styles.css}">
</head>
<body>
    <nav class="navbar">
        <h1>IU Cat Library</h1>
        <div>
            <a href="/search">Search</a>
            <span sec:authorize="isAuthenticated()">
                <a href="/my-rentals">My Rentals</a>
                <form th:action="@{/logout}" method="post" class="logout-form">
                    <button type="submit" class="logout-btn">Logout</button>
                </form>
            </span>
            <span sec:authorize="!isAuthenticated()">
                <a href="/login">Login</a>
            </span>
        </div>
    </nav>

    <div class="container">
        <a href="/search" class="back-link">Back to Search</a>
        
        <div class="book-details-card">
            <h2 th:text="${book.title}">Book Title</h2>
            
            <div class="detail-row">
                <span class="detail-label">Author:</span>
                <span class="detail-value" th:text="${book.author}">Author Name</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">ISBN:</span>
                <span class="detail-value" th:text="${book.isbn}">ISBN</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Availability:</span>
                <span class="detail-value" th:classappend="${book.availableCopies > 0 ? 'available' : 'unavailable'}">
                    <strong><span th:text="${book.availableCopies}"></span></strong> of 
                    <span th:text="${book.totalCopies}"></span> copies available
                </span>
            </div>
            
            <div class="book-details-actions">
                <span sec:authorize="isAuthenticated()">
                    <form th:if="${book.availableCopies > 0}" 
                          th:action="@{/rent/{id}(id=${book.id})}" 
                          method="post">
                        <button type="submit" class="btn btn-primary btn-large">Rent This Book</button>
                    </form>
                    <div th:if="${book.availableCopies == 0}" class="unavailable-message">
                        <p>This book is currently unavailable. All copies are rented out.</p>
                    </div>
                </span>
                
                <span sec:authorize="!isAuthenticated()">
                    <a href="/login" class="btn btn-primary btn-large">Login to Rent This Book</a>
                </span>
            </div>
        </div>
    </div>
</body>
</html>